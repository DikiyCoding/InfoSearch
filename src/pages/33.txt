Конструирование эпидемиологических моделей / Хабр Все сервисы Хабра вчера в 19:18 Конструирование эпидемиологических моделей , Эпидемиология из-за некоторого стечения обстоятельств стала очень популярной за последний год. Интерес к моделированию эпидемий стал возникать у многих и уже всё больше людей знают о вездесущей SIR модели. Но есть ли другие подобные модели? Насколько сложно из вообще создавать и модифицировать? Но обо всём по порядку. За несколько месяцев до появления первых новостей о COVID-19 я для себя, так скажем, в образовательных целях программирования, начал писать программу визуализации эпидемий. В этой простой программе кружочки разных цветов двигались по полю и заражали друг друга. Через полгода, каким-то образом это уже стало темой моей дипломной работы (специальность «биоинженерия и биоинформатика») и пришлось по-настоящему вникать в математическое моделирование эпидемий для написания статей. Благо интернет вдруг стал наполняться эпидемиологическими материалами. Я это виду к тому, что работать я начал за некоторое время до того, как эпидемиология стала мейнстримом. Прежде, чем обсуждать, свои разработки хотел рассказать немного о том, что узнал о математическом моделировании эпидемий. Просто о SIR модели Модель SIR, без упоминания которой не обходится почти ни одна статья по эпидемиологии, создана уже почти век назад. Она проста и элегантна, её много критикуют и много хвалят, как, собственно, любую сущность, которая применима лишь в определённых условиях и имеет свои допущения, о которых необходимо знать во время использования. Я понимаю, что медиапространство заполнено всевозможными описаниями данной модели, поэтому я не побоюсь и добавлю ещё одно. SIR модель. Всю популяцию, которая подвержена эпидемии, разделили на три группы: S (susceptible – восприимчивые, то есть здоровые, не заразные, но могут заразиться, так как не имеют иммунитета), I (infected – инфицированные, то есть болеют и заразны) и R (recovered – выздоровевшие, то есть здоровые, не заразные и не могут заразиться, так как имеют иммунитет). Очевидно, что до начала эпидемии 100 % индивидов находятся в группе S (восприимчивые) и по нулям в остальных группах. Для удобства будем считать, популяция в 100 человек, соответственно S = 100, I = 0, R = 0. В таких условиях эпидемия, конечно, не пойдёт, так как чтобы она началась, должен быть хотя бы один больной. Поэтому рассмотри другую ситуацию: S = 99, I = 1, R = 0. Вот теперь начнётся эпидемия и её моделирование заключается в последовательном высчитывания состояния популяции на следующем шаге. Дальше чуть сложнее, чтобы понимать сколько людей заразиться на каждом шаге, надо понимать наличие двух вероятностей: вероятность контакта между двумя индивидами и вероятность заразить при контакте инфицированного с восприимчивым (β). Часто в модели для воплощения первой вероятности используют просто 1/N (N – объём популяции), подразумевая, что в каждый момент времени каждый индивид контактирует с одним случайным индивидом в популяции. А вторая вероятность (β), обеспечивает собственно биологический показатель заразности конкретного патогена (со всеми влияющим факторами: температура, наличие маски и т.п.). Один инфицированный встретит и заразит в конкретный момент времени конкретного восприимчивого с вероятностью: Тогда всего он заразит восприимчивых индивидов: А все инфицированные вместе заразят восприимчивых Таким образом, количество восприимчивых на втором шаге нашей модели уменьшиться на 0.99*β. Ещё инфицированные выздоравливают, тоже с какой-то вероятностью (γ), которую часто рассматривают как число обратное времени болезни. Имеется в виду, что если болезнь длится 10 дней, то больной индивид в конкретный день выздоровеет с вероятностью γ = 1/10. Получается количество выздоравливающих на каждом шаге будет равно: Количество инфицированных на втором шаге, помимо того, что увеличится на 0.99*β ещё уменьшится на 1*γ. Количество выздоровевших увеличится на 1*γ. Относительного полученного состояния будет высчитываться следующий шаг модели. Таким образом модель формулируется следующими уравнениями: Модификация SEIR О SIR модели слышали теперь довольно многие. О существовании других моделей слышало уже меньше людей. Часто всё-таки вспоминают SEIR модель, которую рассматривают как модификацию SIR. SEIR модель учитывает инкубационный период (E – exposed, индивиды болеют, но не заразны и со временем полностью заболеют). В такой модели заражение восприимчивых происходит таким же способом как в модели SIR, но попадают такие особи не в группу I, а в группу E. А из E с определённой вероятностью (α, число обратное длительности инкубационного периода) происходит переход уже в I. Компартментальные модели в целом Существует ещё много модификаций SIR моделей. Все они, включая саму SIR, являются представителями целого класса моделей, которые называют «компартментальными эпидемиологическими моделями». Упоминаемое выше разделение популяции на группы или компартменты (отсеки) как раз и обуславливает такое название моделей. Сложность компартментальных моделей не ограничена тремя или четырьмя группами. Такие модели могут учитывать самые различные сценарии: введение карантинных мер (SIQR, добавляется группа Q – quarantine), потеря иммунитета (SIRS, переход с некоторой вероятностью из R обратно в S), группы риска у восприимчивых (несколько групп S: S1, S2, …, каждая из которых со своей вероятностью заражается), различные варианты течения болезни (несколько групп I: I1, I2, …, в каждую из которых своя вероятность попадания восприимчивых особей, а также у каждой допустим своя заразность) и т.д. Ограничением здесь является только фантазия исследователя. Сложные схемы компартментальных моделей часто описывают в виде графа переходов. Вот, например модель для туберкулёза из : Схема распространения туберкулёза Реализация компартментальных моделей заключается в описании уравнений переходов и последующем расчёте изменений каждого компартмента в течение какого-то периода. DEMMo (конструктор моделей) В этом и заключается назначение разрабатываемой мной программы DEMMo. DEMMo – Designer of Epidemic Math Models (конструктор эпидемиологических математических моделей). Конструированные модели организуется в объектно-ориентированном виде. Есть класс стадии (аналог компартмента), класс потока (обеспечивает переход индивидов между стадиями) и внешнего потока (прибавление/вычитание индивидов к/из стадии). Подробную инструкцию по использованию программы попытался написать в . Результаты различных моделей, реализованных с использованием программы Программу писал на python. Интерфейс на PyQt5. Выложил исходный код программы на (с git работал впервые) и архив с готовой версией для windows на Будем считать, что начинаю бета тестирование программы. Надеюсь, я хоть немного понятно объяснил и для тех, кому интересно, буду очень рад если программу жестоко поэксплуатируют. Вроде бы настроил систему создания отчётов об ошибках. Это мой первый крупный проект после задачек на ряды Фибоначчи и т.п. Код очень плохо задокументирован, причём часть комментариев на русском, а часть на английском. Знаю, что плохо, каюсь. Надеюсь займусь этим. Если будут какие-то конкретные советы от матёрых программистов, буду очень рад. Контактная почта: demmo.development@gmail.com Так уж вышло, что актуальность темы моего диплома резко возросла за последние полтора года. Надеюсь, мейнстрим никого не отпугнул и кому-нибудь было интересно и познавательно. Спасибо за внимание. Теги: Добавить метки Хабы: Укажите причину минуса, чтобы автор поработал над ошибками Отправить анонимно Пометьте публикацию своими метками Метки лучше разделять запятой. Например: программирование, алгоритмы Сохранить Баннер исчез, но на прощание оставил коллекцию по работе с продуктами от Microsoft Читают сейчас 17,5k 5,3k 11,2k 14,3k 2,5k 1124k Мегапост Редакторский дайджест Присылаем лучшие статьи раз в месяц Скоро на этот адрес придет письмо. Подтвердите подписку, если всё в силе. +4 5 669 Поделиться Скопировать ссылку Нарушение Опишите суть нарушения Отправить Пользователь Платежная система Похожие публикации 5 мая 2020 в 20:51 8 6,4k 83 18 сентября 2019 в 12:01 27 10,8k 93 12 июня 2019 в 09:53 19 38k 215 AdBlock похитил этот баннер, но баннеры не зубы — отрастут Минуточку внимания Комментарии 13 вчера в 19:37 0 Учитывают-ли данные модели географию? Симулируют-ли они поведение людей? Я спрашиваю потому, что все модели, что описывались в популярных статьях это какая-то фикция. Чем могут помочь графики без привязки к географии? На мой делитантский взглят тут больше подходят модели типа погодных, движения воздуха/жидкости или симуляции ядерных взрывов. Другой перспективный (опять-же на мой взгляд) подход будет симуляция систем частиц. Все такие модели схожи требованием огромных вычислительных мощьностей. вчера в 19:55 0 Проблема не в самой модели. Модель содержит максимально абстрактные вероятностные переменные. Проблема в том, для каких групп величина этих переменных считается одной и той же, и из статистики какого качества эта величина берётся. Естественно, при ленивом моделировании, оказывается, что выборка — заведомо велика, и получается, почти в прямом смысле, средняя температура по больнице, включая морг. сегодня в 06:43 0 Да, Вы правы. Степень разделения на группы, то есть степень принятия допущений одинаковости индивидов, является одним из самых сложных моментов моделирования. Этот этап требует реальной статистической оценки разделения популяции на выбранные группы. сегодня в 06:37 0 Действительно, возможных вариантов моделирования очень много, начиная от чисто математического анализа временных рядов или предсказания динамики изменений с использованием глубокого обучения до имитационных моделей. То, что Вы предлагаете, наверное, стоит относить именно к имитационным моделям и, думаю, действительно может применяться в эпидемиологических целях, надо поискать и разобраться. Но как Вы правильно заметили, подобные модели требуют больших вычислительных мощностей. Компартментальные модели в свою очередь это максимально простые по вычислениям системы. Имитационные или индивидуум-ориентированные модели — это хорошая вещь и, думаю, они максимально точные. Однако иногда стоит сделать допущения, экономящие ресурсы, но не влияющие существенно на точность. Например, объединение индивидов в группы по схожим свойствам, чтобы не просчитывать каждого конкретного по отдельности, как это и происходит по факту в компартментальных моделях. Ваш вопрос натолкнул меня на хорошую идею, благодарю. Конкретно описанные в статье модели не могут учитывать географию. И за это как раз часто и ругают SIR модель. Однако я хотел сказать, что компартментальные модели — это неисчерпаемый источник новых моделей, которые могут учитывать различные, необходимые в конкретной ситуации факторы. Например, географию. Можно условно разделить моделируемый географический участок на такие же группы. Допустим на страны/регионы/города или ещё мельче. Для каждого региона будет свой компартмент S и соответственно I и R, которые имеют свои вероятности переходов и коэффициенты воздействия на другие географические участки. С поведением также. Объединяем индивидов популяции в группы по схожему поведению. Например, носящие маски и игнорирующие маски. Каждая группа, конечно, имеет свой коэффициент заразности и восприимчивости. Графики же самый простой способ визуализации. Действительно, если будет географическое разделение, можно визуализировать распространение цветами на карте. вчера в 21:38 0 Структура таких моделей более или менее хорошо известна, главная сложность — это подбор параметров модели в соответствии с известными статистическими данными. Рекомендую , в которой приведена программа для Matlab, позволяющая подобрать параметры на основе данных о смертности, количестве новых случаев заболевания и количестве выздоровевших. Вот результат применения этой программы к анализу эпидемии COVID-19 в Украине, правда, сейчас данные уже устарели (модель строилась по данным на 15 ноября 2020 года) " сегодня в 06:50 0 Да, описанные структуры классические и хорошо известные. Хотел показать именно возможности создания (придумывания) новых моделей. Благодарю за ссылку. Оценка параметров и правда самый сложный момент. Боюсь даже за него браться. сегодня в 03:28 0 А откуда берутся вторая волна, третья?.. Хотя бы на качественном уровне. Типа начался спад, све расслабились… Или как? сегодня в 07:24 0 Не туда написал ответ, смотрите ниже. сегодня в 07:10 0 Учитывается ли группа не переболевших, но по не выясненной ещё причине не восприимчивые? сегодня в 07:30 0 Да вполне возможно создание такой группы. То есть группа, индивиды которой изначально не восприимчивы, вне зависимости от распространения эпидемии. сегодня в 07:19 0 Хороший вопрос. Возможны различные варианты. Например, на графике SIRS, показанном в посте. Здесь у индивидов со временем пропадает иммунитет. То есть инфекция не успевает полностью пройти, когда у основной части заражённых начинает исчезать иммунитет и они снова становятся восприимчивы и возникает вторая волна эпидемии. И так далее. Но я думаю, это не та причина, которая обуславливает волны COVID. Если модель учитывает рождаемость и смертность, то волны происходят из-за появления новорожденных, у которых нет иммунитета. Но это тоже пока не про COVID — слишком мало времени ещё прошло, чтобы говорить о таких волнах. Классической причиной возникновения волн гриппа являются сезонные колебания температуры, которые изменяют возможности распространения вируса. Также возможно влияет введение карантинных мер на определённый период. Их эффективность это отдельный разговор и повод для споров. Сейчас, конечно, не об этом. В любом случае меняется эффективность заражения. сегодня в 07:30 0 Я правильно понимаю что в этих моделях «умер»==«выздоровел» )). сегодня в 08:37 0 И где хоть одна модель, которая объясняет "волны"? Только могут оставлять комментарии. , пожалуйста. Что обсуждают 35,8k 2,5k 24,4k 14,2k Мегапост 17,5k 3,7k 9,4k 14,3k Мегапост 31,9k 33,5k 104k 22,2k Подборка Самое читаемое +49 17,5k 53 +111 71k 65 +52 14,3k 58 +20 14,2k 2 Мегапост +218 104k 83 +111 71k 65 +45 66,6k 144 +62 36,6k 58 Мегапост +231 252k 446 +56 213k 112 +592 209k 505 +62 174k 111 Мегапост Ваш аккаунт Разделы Информация Услуги © 2006 – 2021 «» Настройка языка Интерфейс Русский English Язык публикаций Русский Английский Сохранить настройки